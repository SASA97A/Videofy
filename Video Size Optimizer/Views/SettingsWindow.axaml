<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
		xmlns:vm="using:Video_Size_Optimizer.ViewModels"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
        x:Class="Video_Size_Optimizer.Views.SettingsWindow"
		x:DataType="vm:SettingsViewModel"
        Title="Global Settings" Width="400" Height="650"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource MainBackground}" Foreground="{DynamicResource MainText}">

	<Grid RowDefinitions="*, Auto">
		<ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
	<StackPanel Margin="20" Spacing="20">
		<TextBlock Text="Encoder Settings" FontSize="18" FontWeight="Bold" Foreground="{DynamicResource SystemAccentColor}"/>

		<StackPanel Spacing="5">
			<CheckBox IsChecked="{Binding DeleteOriginal}" Cursor="Hand" Content="Delete original file after successful compression"/>
			<StackPanel Orientation="Horizontal" Spacing="6" Margin="32,0,0,0">
				<Image Width="12" Height="12" VerticalAlignment="Center">
					<Image.Source>
						<SvgImage Source="/Assets/warning.svg"/>
					</Image.Source>
				</Image>
				<TextBlock Text="Warning: This action cannot be undone."
						   FontSize="11"
						   Foreground="{DynamicResource DimText}"
						   VerticalAlignment="Center"
						   />
			</StackPanel>
		</StackPanel>

		<StackPanel Spacing="5">
			<CheckBox IsChecked="{Binding ProcessAlreadyOptimized}"
					  Cursor="Hand"
					  Content="Allow processing of already optimized videos"/>
			<TextBlock Text="Allows re-compressing files containing '-CRF' or '-Target'"
					   FontSize="11" Foreground="{DynamicResource DimText}" Margin="32,0,0,0"/>
		</StackPanel>

		<StackPanel Spacing="5">
			<CheckBox IsChecked="{Binding PreventUpsampling}"
					  Cursor="Hand"
					  Content="Enable Bitrate Ceiling (Safety Cap)"/>
			<TextBlock Text="Ensures the output file never exceeds the original bitrate. 
					   Useful for grainy or noisy videos where CRF might otherwise increase the file size."
					   FontSize="11"
					   Foreground="{DynamicResource DimText}"
					   Margin="32,0,0,0"
					   TextWrapping="Wrap"
					   Opacity="0.8"/>
		</StackPanel>

		<CheckBox IsChecked="{Binding PreventSleep}" Cursor="Hand" Content="Prevent system sleep during processing"/>
		
		<StackPanel Spacing="5">
			<StackPanel Orientation="Horizontal" Spacing="10">
				<TextBlock Text="Pause if disk space is below:" />
				<TextBlock Text="{Binding LowDiskBufferGb, StringFormat='{}{0} GB'}"
						   Foreground="{DynamicResource SystemAccentColor}" FontWeight="Bold" FontSize="12"/>
			</StackPanel>
			<Border Padding="10,0,10,0">
			<Slider Value="{Binding LowDiskBufferGb}" Minimum="2" Maximum="80"
					TickFrequency="1" IsSnapToTickEnabled="True" Cursor="Hand"/>
			</Border>
		</StackPanel>

		<StackPanel Spacing="5">
			<TextBlock Text="Default Output Format:" FontSize="12"/>
			<ComboBox ItemsSource="{Binding OutputFormats}"
                      SelectedItem="{Binding SelectedFormat}"
                      Width="150" Cursor="Hand"/>
		</StackPanel>

		<StackPanel Spacing="5" Margin="0,10,0,0">
			<TextBlock Text="Hardware Acceleration"
					   FontSize="18"
					   FontWeight="Bold"
					   Foreground="{DynamicResource SystemAccentColor}"
					   Margin="5,0,0,10"/>

			<Border Background="#252525"
					BorderBrush="{DynamicResource InputBackground}"
					BorderThickness="1"
					CornerRadius="6"
					Padding="12,8">

				<StackPanel>
					<TextBlock Text="Enable specific hardware encoders for your GPU:"
							   FontSize="11"
							   Foreground="{DynamicResource SecondaryText}"
							   Margin="0,0,0,10"/>

					<ItemsControl ItemsSource="{Binding EncoderOptions}">
						<ItemsControl.ItemTemplate>
							<DataTemplate>
								<CheckBox Content="{Binding Name}"
										  IsChecked="{Binding IsIncluded}"
										  FontSize="12"
										  Margin="0,2"
										  Cursor="Hand"/>
							</DataTemplate>
						</ItemsControl.ItemTemplate>
					</ItemsControl>
				</StackPanel>
			</Border>
		</StackPanel>


		<StackPanel Spacing="5" Margin="0,10,0,0">
			<TextBlock Text="Misc" FontSize="18" FontWeight="Bold" Foreground="{DynamicResource SystemAccentColor}" Margin="0,0,0,5"/>

			<TextBlock Text="Additional Input Formats" FontSize="12" Foreground="{DynamicResource MainText}"/>

			<TextBox Text="{Binding CustomExtensions}"
					 Watermark="e.g. .mxf, .raw (comma separated)"
					 FontSize="12"
					 Background="#252525"
					 BorderBrush="{DynamicResource InputBackground}">
				<ToolTip.Tip>
					<StackPanel Spacing="2">
						<TextBlock Text="Videofy will attempt to read these formats when opening folders." FontWeight="SemiBold"/>
						<TextBlock Text="Note: Processing success depends on your local FFmpeg capabilities." Foreground="{DynamicResource WarningColor}" FontSize="11"/>
					</StackPanel>
				</ToolTip.Tip>
			</TextBox>
		</StackPanel>


		<StackPanel Spacing="5">
			<CheckBox IsChecked="{Binding UseSoftwareRendering}"
					  Cursor="Hand"
					  Content="Disable UI Hardware Acceleration"/>
			<TextBlock Text="Turn this on if you experience flickering, invisible tooltips, or UI lag. Requires settings to be saved (Rememberd) then an application restart to take effect."
					   FontSize="11"
					   Foreground="{DynamicResource WarningColor}"
					   Margin="32,0,0,0"
					   TextWrapping="Wrap"/>
		</StackPanel>



	</StackPanel>
	</ScrollViewer>
		
		
		<Border Grid.Row="1" Background="#252525" BorderBrush="{DynamicResource InputBackground}" BorderThickness="0,1,0,0" Padding="20,10">
			<Grid ColumnDefinitions="*, Auto">
				<CheckBox IsChecked="{Binding SaveToDisk}" Content="Remember settings" FontSize="12" VerticalAlignment="Center" Cursor="Hand"/>
				<Button Grid.Column="1" Content="Save &amp; Close" Click="OnSaveClick" Background="{DynamicResource SystemAccentColor}" Foreground="Black" FontWeight="Bold" Padding="15,8" Cursor="Hand"/>
			</Grid>
		</Border>
	</Grid>
	
</Window>
